<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>MongoDB Database Explorer</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .container { max-width: 1200px; }
        .book-card { border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .json-view { background: #f5f5f5; padding: 10px; border-radius: 3px; font-family: monospace; }
        .nav { margin-bottom: 20px; }
        .nav a { margin-right: 15px; text-decoration: none; color: #007bff; }
        .btn { padding: 8px 16px; background: #007bff; color: white; text-decoration: none; border-radius: 3px; }
        .stats { background: #e9ecef; padding: 15px; border-radius: 5px; margin-bottom: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="nav">
            <a href="/">‚Üê Back to Bookstore</a>
            <a href="/addbook">Add Book</a>
        </div>

        <h1>MongoDB Database Explorer</h1>

        <div class="stats">
            <h3>Database Statistics</h3>
            <p><strong>Total Books in MongoDB:</strong> <span th:text="${#lists.size(mongoBooks)}">0</span></p>
            <p><strong>Database:</strong> bookstore</p>
            <p><strong>Collection:</strong> books</p>
        </div>

        <div th:if="${#lists.isEmpty(mongoBooks)}">
            <div class="book-card">
                <h3>No books found in MongoDB</h3>
                <p>Click the button below to add a test book:</p>
                <a href="/mongo/add-sample" class="btn">Add Sample Books</a>
            </div>
        </div>

        <div th:if="${!#lists.isEmpty(mongoBooks)}">
            <h2>Books in MongoDB Collection</h2>

            <div class="book-card" th:each="book : ${mongoBooks}">
                <h3 th:text="${book.getString('title')}">Book Title</h3>
                <p><strong>Author:</strong> <span th:text="${book.getString('author')}">Author</span></p>
                <p><strong>Year:</strong> <span th:text="${book.getInteger('publicationYear')}">Year</span></p>
                <p><strong>ISBN:</strong> <span th:text="${book.getString('isbn')}">ISBN</span></p>
                <p><strong>Price:</strong> $<span th:text="${book.getDouble('price')}">Price</span></p>

                <details>
                    <summary>View Raw JSON</summary>
                    <div class="json-view" th:text="${book.toJson()}">JSON Data</div>
                </details>
            </div>

            <div style="margin-top: 20px;">
                <a href="/mongo/add-sample" class="btn">Add More Sample Books</a>
                <a href="/mongo/clear" class="btn" style="background: #dc3545;">Clear All Books</a>
            </div>
        </div>

        <hr style="margin: 40px 0;">

        <h2>Database Operations</h2>
        <div class="book-card">
            <h4>Available Operations:</h4>
            <ul>
                <li><a href="/mongo/test">Refresh Page</a> - Reload database view</li>
                <li><a href="/mongo/add-sample">Add Sample Data</a> - Insert test books</li>
                <li><a href="/mongo/clear">Clear Collection</a> - Remove all books</li>
            </ul>
        </div>
    </div>
</body>
</html>